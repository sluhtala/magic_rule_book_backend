(this.webpackJsonpmg_rulebook=this.webpackJsonpmg_rulebook||[]).push([[0],{161:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(48),s=n.n(c),a=n(11),i=n(102),u=n.n(i),o=n(119),l=n(120),d=n.n(l),j={getData:function(){var e=Object(o.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.get("/rules.txt");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()};var b={parseData:function(e){var t={headers:[],subHeaders:[],rules:[]},n=e.split("\n\r").map((function(e){return e.trim()})),r=n.indexOf("1. Game Concepts"),c=n.lastIndexOf("Glossary");return n.slice(r,c).forEach((function(e,n){var r=e.substring(0,e.indexOf(" "));if(/^[1-9]\.$/.test(r))t.headers.push({id:n,text:e});else if(/^[1-9][0-9][0-9]\.$/.test(r))t.subHeaders.push({id:n,text:e});else{if(0===e.length)return;var c=parseInt(e.substr(0,1)),s=parseInt(e.substring(0,e.indexOf(".")));t.rules.push({id:n,text:e.replace("\u2013","-"),headerNum:c,subNum:s})}})),t}},f=n(183),x=n(172),O=n(176),h=n(32),g=(n(153),function(e,t){var n=RegExp("^".concat(t,"[.]"));return e.filter((function(e){return n.test(e.text)}))}),v=function(e,t,n){return""===n?e:e.filter((function(e){var n=parseInt(e.text.substring(0,1));return t.some((function(e){return e.headerNum===n}))}))},m=function(e,t,n){return""===n?e:e.filter((function(e){var n=parseInt(e.text.substr(0,e.text.indexOf(".")));return t.some((function(e){return e.subNum===n}))}))},p=n(184),k=n(175),C=n(182),S=n(180),w=n(4),I=function(e){var t=e.sub,n=e.subHeaderClick;return Object(w.jsx)(S.a.Item,{className:"ui",as:"a",onClick:function(){return n(t)},children:t})},H=function(e){var t=e.subHeaders,n=e.subHeaderClick;return Object(w.jsx)(S.a,{children:t.map((function(e){return Object(w.jsx)(I,{sub:e.text,subHeaderClick:n},e.id)}))})},E=n(181),A=function(e){var t=e.header,n=e.subHeaders,c=e.subHeaderClick,s=e.index,i=e.headersActive,u=parseInt(t),o=Object(r.useState)([]),l=Object(a.a)(o,2),d=l[0],j=l[1],b=Object(r.useState)(!1),f=Object(a.a)(b,2),x=f[0],O=f[1];return Object(r.useEffect)((function(){j(function(e,t){if(0!==e.length){var n=RegExp("^"+t);return e.filter((function(e){return n.test(e.text)}))}}(n,u))}),[n,u]),Object(r.useEffect)((function(){t.substring(0,1)===i||"all"===i?O(!0):O(!1)}),[i,t]),Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(E.a.Title,{onClick:function(){return O(!x)},index:s,active:x,children:Object(w.jsx)(C.a,{size:"small",children:t})}),Object(w.jsx)(E.a.Content,{active:x,children:Object(w.jsx)(H,{subHeaders:d,subHeaderClick:c})})]})},R=function(e){var t=e.headers,n=e.subHeaders,r=e.subHeaderClick,c=e.headersActive;return Object(w.jsx)(E.a,{fluid:!0,as:f.a,children:t.map((function(e,t){return Object(w.jsx)(A,{index:t,header:e.text,subHeaders:n,subHeaderClick:r,headersActive:c},e.id)}))})},M=n(179),N=n(178),y=n(173),T=n(162),B=n(177),F=function(e){var t=Object(r.useState)(e.rules[e.index]),n=Object(a.a)(t,2),c=n[0],s=n[1],i=e.rules.length;if(Object(r.useEffect)((function(){s(e.rules[e.index])}),[e.index,e.rules]),!c)return"";var u=c.text.substring(0,c.text.indexOf(" "));return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(B.a.Header,{children:Object(w.jsx)(C.a,{children:u})}),Object(w.jsx)(B.a.Content,{children:Object(w.jsx)(x.a,{text:!0,fluid:!0,children:c.text.substring(c.text.indexOf(" "))})}),i>1&&Object(w.jsxs)(B.a.Actions,{children:[Object(w.jsx)(T.a,{icon:"arrow left",disabled:e.index<=0,onClick:function(){e.setIndex(e.index-1)}}),Object(w.jsx)(T.a,{icon:"arrow right",disabled:e.index>=i-1,onClick:function(){e.setIndex(e.index+1)}})]})]})},L=function(e){var t=Object(r.useState)(0),n=Object(a.a)(t,2),c=n[0],s=n[1];return Object(r.useEffect)((function(){s(0)}),[e.rules]),Object(w.jsx)(B.a,{closeIcon:"close",content:Object(w.jsx)(F,{rules:e.rules,index:c,setIndex:s}),on:"click",trigger:e.trigger})},G=function(e){var t=e.rule,n=e.activeIndex,r=e.id,c=e.setActiveIndex,s=e.rBook,a=e.modalRules,i=e.setModalRules,u=t.substring(0,t.indexOf(" ")),o=t.substring(t.indexOf(" ")+1),l=o.substring(0,30);return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)(E.a.Title,{index:r,active:n===r,onClick:function(){c(r===n?-1:r)},children:[Object(w.jsx)(h.a,{name:"dropdown"}),Object(w.jsx)("b",{children:u}),n!==r&&Object(w.jsxs)(w.Fragment,{children:[" ",l,t.length<30?"":"..."]})]}),Object(w.jsx)(E.a.Content,{active:n===r,children:Object(w.jsx)(N.a,{duration:500,animation:"fade down",visible:n===r,children:Object(w.jsx)("div",{children:function(e){var t=e.split("\n"),n=/[1-9][0-9]{2}(\.|\.([1-9])|$)/;return t.map((function(e,t){return Object(w.jsx)("div",{children:e.split(/([ (,)])/).map((function(e,t){return n.test(e)?Object(w.jsx)(L,{rules:a,trigger:Object(w.jsx)(M.a,{as:"a",style:{cursor:"pointer"},size:"tiny",onClick:function(){return function(e){var t=g(s.rules,parseInt(e)),n=e.indexOf("-");if(-1===n)"."===e[e.length-1]&&(e=e.substr(0,e.length-1)),i(t.filter((function(t){return t.text.substring(0,t.text.indexOf(" ")).includes(e)})));else{if(isNaN(e[n-1])){var r=e[n+1].charCodeAt(0)-e[n-1].charCodeAt(0)+1,c=t.map((function(e){return e.text.substring(0,e.text.indexOf(" "))})).indexOf(e.substr(0,n));return void i(t.slice(c,c+r))}for(var a=parseInt(e.substring(e.indexOf(".")+1,n)),u=parseInt(e.substring(n+1)),o=e.substring(0,e.indexOf(".")),l=[],d=a;d<=u;d++)l.push(RegExp("".concat(o,"[.]").concat(d)));var j=t.filter((function(e){var t=!1;return l.forEach((function(n){n.test(e.text.substring(0,e.text.indexOf(" ")))&&(t=!0)})),t}));i(j)}}(e)},children:e})},t):e}))},t)}))}(o)})})})]})},z=function(e){var t=e.autoLoadMore,n=e.showMore,r=e.isLoading;return Object(w.jsx)(y.a,{onOnScreen:function(){t()},continuous:!0,children:Object(w.jsx)(T.a,{loading:r,icon:"arrow down",onClick:function(){return n()}})})},D=function(e){var t=e.rules,n=e.setSearch,c=e.showMore,s=e.displayAmount,i=e.rBook,u=Object(r.useState)(-1),o=Object(a.a)(u,2),l=o[0],d=o[1],j=Object(r.useState)([]),b=Object(a.a)(j,2),f=b[0],x=b[1],O=Object(r.useState)(!1),h=Object(a.a)(O,2),g=h[0],v=h[1],m=Object(r.useState)([]),p=Object(a.a)(m,2),k=p[0],C=p[1];Object(r.useEffect)((function(){x(t.slice(0,s)),v(!1)}),[s,t]);return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(L,{}),Object(w.jsx)(E.a,{styled:!0,fluid:!0,children:f.map((function(e){return Object(w.jsx)(G,{id:e.id,rule:e.text,activeIndex:l,setActiveIndex:d,setSearch:n,rBook:i,modalRules:k,setModalRules:C},e.id)}))}),t.length>s&&Object(w.jsx)(z,{autoLoadMore:function(){v(!0),setTimeout((function(){c()}),150)},showMore:c,isLoading:g})]})},$=n(174),J=function(e){return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)($.a,{placeholder:"search",fluid:!0,icon:"search",value:e.value,onChange:e.onChange,loading:e.loading}),e.searchResultNumber," ",1===e.searchResultNumber?"result":"results"," found",""!==e.value&&Object(w.jsx)(T.a,{onClick:e.clearSearch,compact:!0,basic:!0,size:"tiny",children:"clear"})]})},_=function(e){var t=e.rBook,n=Object(r.useState)(t.rules),c=Object(a.a)(n,2),s=c[0],i=c[1],u=Object(r.useState)(0),o=Object(a.a)(u,2),l=o[0],d=o[1],j=Object(r.useState)(""),b=Object(a.a)(j,2),f=b[0],x=b[1],O=Object(r.useState)(!1),h=Object(a.a)(O,2),S=h[0],I=h[1],H=Object(r.useState)(30),E=Object(a.a)(H,2),A=E[0],M=E[1],N=Object(r.useState)(""),y=Object(a.a)(N,2),T=y[0],B=y[1],F=Object(r.useState)("Magic: The Gathering -rulebook"),L=Object(a.a)(F,2),G=L[0],z=L[1];Object(r.useEffect)((function(){if(M(30),0!==f.length){I(!0);var e=setTimeout((function(){i(function(e,t){return""===t?e:e.filter((function(e){return e.text.toLowerCase().includes(t.toLowerCase())}))}(t.rules,f)),I(!1)}),700);return function(){clearTimeout(e)}}I(!1)}),[f,t.rules]);var $=function(){x(""),B(""),i(t.rules),z("Magic: The Gathering -rulebook")};Object(r.useEffect)((function(){d(s.length)}),[s]);return Object(w.jsx)(p.a,{stackable:!0,children:Object(w.jsxs)(p.a.Row,{columns:2,divided:!0,children:[Object(w.jsx)(p.a.Column,{width:5,children:Object(w.jsx)(R,{headers:v(t.headers,s,f),subHeaders:m(t.subHeaders,s,f),subHeaderClick:function(e){x(""),i(g(t.rules,parseInt(e))),B(e.substring(0,1)),z(e)},headersActive:T})}),Object(w.jsxs)(p.a.Column,{width:11,children:[Object(w.jsx)(p.a.Row,{children:Object(w.jsx)(J,{value:f,onChange:function(e){var t=e.target;x(t.value),I(!1),""===t.value?$():B("all")},loading:S,searchResultNumber:l,clearSearch:$})}),Object(w.jsxs)(p.a.Row,{children:[Object(w.jsx)(k.a,{}),Object(w.jsx)(C.a,{children:f?"Search result for:'".concat(f,"'"):G}),Object(w.jsx)(D,{rules:s,setSearch:x,displayAmount:A,showMore:function(){M(A+30)},rBook:t})]})]})]})})};var q=function(){var e=Object(r.useState)({}),t=Object(a.a)(e,2),n=t[0],c=t[1],s=Object(r.useState)(!1),i=Object(a.a)(s,2),u=i[0],o=i[1],l=Object(r.useState)(!1),d=Object(a.a)(l,2),g=d[0],v=d[1];return Object(r.useEffect)((function(){o(!0),j.getData().then((function(e){c(b.parseData(e)),o(!1)})).catch((function(e){console.error(e),v(!0),o(!1)}))}),[]),Object(w.jsxs)("div",{children:[Object(w.jsx)(f.a,{inverted:!0,basic:!0,children:"An unofficial Magic: The Gathering -rulebook"}),Object(w.jsxs)(x.a,{fluid:!0,textAlign:"left",text:!0,children:[Object(w.jsx)(O.a,{active:u}),g&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(h.a,{name:"x",size:"massive",color:"red"}),Object(w.jsx)("div",{children:"Error loading resources"})]}),n.headers&&n.subHeaders&&n.rules&&Object(w.jsx)(_,{rBook:n})]})]})};s.a.render(Object(w.jsx)(q,{}),document.getElementById("root"))}},[[161,1,2]]]);
//# sourceMappingURL=main.531694c2.chunk.js.map