(this.webpackJsonpmg_rulebook=this.webpackJsonpmg_rulebook||[]).push([[0],{161:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(48),s=n.n(c),i=n(11),a=n(102),u=n.n(a),o=n(119),l=n(120),d=n.n(l),b={getData:function(){var e=Object(o.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.get("/rules.txt");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()};var j={parseData:function(e){var t={headers:[],subHeaders:[],rules:[]},n=e.split("\n\r").map((function(e){return e.trim()})),r=n.indexOf("1. Game Concepts"),c=n.lastIndexOf("Glossary");return n.slice(r,c).forEach((function(e,n){var r=e.substring(0,e.indexOf(" "));if(/^[1-9]\.$/.test(r))t.headers.push({id:n,text:e});else if(/^[1-9][0-9][0-9]\.$/.test(r))t.subHeaders.push({id:n,text:e});else{if(0===e.length)return;var c=parseInt(e.substr(0,1)),s=parseInt(e.substring(0,e.indexOf(".")));t.rules.push({id:n,text:e.replace("\u2013","-"),headerNum:c,subNum:s})}})),t}},f=n(183),x=n(172),O=n(176),h=n(32),g=(n(153),function(e,t){var n=RegExp("^".concat(t,"[.]"));return e.filter((function(e){return n.test(e.text)}))}),v=function(e,t,n){return""===n?e:e.filter((function(e){var n=parseInt(e.text.substring(0,1));return t.some((function(e){return e.headerNum===n}))}))},m=function(e,t,n){return""===n?e:e.filter((function(e){var n=parseInt(e.text.substr(0,e.text.indexOf(".")));return t.some((function(e){return e.subNum===n}))}))},p=n(184),k=n(175),C=n(182),w=n(180),S=n(4),H=function(e){var t=e.sub,n=e.subHeaderClick;return Object(S.jsx)(w.a.Item,{className:"ui",as:"a",onClick:function(){return n(t)},children:t})},I=function(e){var t=e.subHeaders,n=e.subHeaderClick;return Object(S.jsx)(w.a,{children:t.map((function(e){return Object(S.jsx)(H,{sub:e.text,subHeaderClick:n},e.id)}))})},E=n(181),A=function(e){var t=e.header,n=e.subHeaders,c=e.subHeaderClick,s=e.index,a=e.headersActive,u=parseInt(t),o=Object(r.useState)([]),l=Object(i.a)(o,2),d=l[0],b=l[1],j=Object(r.useState)(!1),f=Object(i.a)(j,2),x=f[0],O=f[1];return Object(r.useEffect)((function(){b(function(e,t){if(0!==e.length){var n=RegExp("^"+t);return e.filter((function(e){return n.test(e.text)}))}}(n,u))}),[n,u]),Object(r.useEffect)((function(){t.substring(0,1)===a||"all"===a?O(!0):O(!1)}),[a,t]),Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(E.a.Title,{onClick:function(){return O(!x)},index:s,active:x,children:Object(S.jsx)(C.a,{size:"small",children:t})}),Object(S.jsx)(E.a.Content,{active:x,children:Object(S.jsx)(I,{subHeaders:d,subHeaderClick:c})})]})},y=function(e){var t=e.headers,n=e.subHeaders,r=e.subHeaderClick,c=e.headersActive;return Object(S.jsx)(E.a,{fluid:!0,as:f.a,children:t.map((function(e,t){return Object(S.jsx)(A,{index:t,header:e.text,subHeaders:n,subHeaderClick:r,headersActive:c},e.id)}))})},B=n(179),M=n(178),N=n(173),R=n(162),T=n(177),F=function(e){var t=Object(r.useState)(e.rules[e.index]),n=Object(i.a)(t,2),c=n[0],s=n[1],a=e.rules.length;if(Object(r.useEffect)((function(){s(e.rules[e.index])}),[e.index,e.rules]),!c)return"";var u=c.text.substring(0,c.text.indexOf(" "));return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(T.a.Header,{children:Object(S.jsx)(C.a,{children:u})}),Object(S.jsx)(T.a.Content,{children:Object(S.jsx)(x.a,{text:!0,fluid:!0,children:c.text.substring(c.text.indexOf(" "))})}),a>1&&Object(S.jsxs)(T.a.Actions,{children:[Object(S.jsx)(R.a,{icon:"arrow left",disabled:e.index<=0,onClick:function(){e.setIndex(e.index-1)}}),Object(S.jsx)(R.a,{icon:"arrow right",disabled:e.index>=a-1,onClick:function(){e.setIndex(e.index+1)}})]})]})},L=function(e){var t=e.trigger,n=e.word,c=e.rBook,s=Object(r.useState)(0),a=Object(i.a)(s,2),u=a[0],o=a[1],l=Object(r.useState)([]),d=Object(i.a)(l,2),b=d[0],j=d[1];Object(r.useEffect)((function(){o(0)}),[n]);return Object(S.jsx)(T.a,{closeIcon:"close",content:Object(S.jsx)(F,{rules:b,index:u,setIndex:o}),on:"click",trigger:t,onOpen:function(){return function(){var e="."===n[n.length-1]?n.slice(0,n.length-1):n,t=g(c.rules,parseInt(e)),r=e.indexOf("-");if(-1===r)j(t.filter((function(t){return t.text.substring(0,t.text.indexOf(" ")).includes(e)})));else{var s,i=e.substring(0,e.indexOf(".")),a=e.substring(0,r),u=e.substring(r+1),o=t.find((function(e){return e.text.substring(0,e.text.indexOf(" ")).includes(a)})).id,l=e.substring(r+1);u.match(/[0-9]{3}/)||(l=u.match(/^[a-z]$/)?"".concat(e.substring(0,r-1)).concat(u):"".concat(i,".").concat(u)),s=t.find((function(e){return e.text.substring(0,e.text.indexOf(" ")).includes(l)})).id;for(var d=[],b=function(e){d.push(t.find((function(t){return t.id===e})))},f=o;f<=s;f++)b(f);j(d)}}()}})},z=function(e){var t=e.rule,n=e.activeIndex,c=e.id,s=e.setActiveIndex,a=e.rBook,u=t.substring(0,t.indexOf(" ")),o=t.substring(t.indexOf(" ")+1),l=o.substring(0,30),d=Object(r.useState)(null),b=Object(i.a)(d,2),j=b[0],f=b[1],x=function(e){var t=e.split("\n"),n=/^[1-9][0-9][0-9]((\.([0-9]|$))|$)/;f(t.map((function(e,t){return Object(S.jsx)("div",{children:e.split(/([ ()])/).map((function(e,t){var r=","===e[e.length-1]?e.substring(0,e.length-1):e;return n.test(r)?Object(S.jsx)(L,{word:r,rBook:a,trigger:Object(S.jsx)(B.a,{as:"a",style:{cursor:"pointer"},size:"tiny",children:e})},t):e}))},t)})))};return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)(E.a.Title,{index:c,active:n===c,onClick:function(){c===n?s(-1):(s(c),x(o))},children:[Object(S.jsx)(h.a,{name:"dropdown"}),Object(S.jsx)("b",{children:u}),n!==c&&Object(S.jsxs)(S.Fragment,{children:[" ",l,t.length<30?"":"..."]})]}),Object(S.jsx)(E.a.Content,{active:n===c,children:Object(S.jsx)(M.a,{duration:500,animation:"fade down",visible:n===c,children:Object(S.jsx)("div",{children:j})})})]})},G=function(e){var t=e.autoLoadMore,n=e.showMore,r=e.isLoading;return Object(S.jsx)(N.a,{onOnScreen:function(){t()},continuous:!0,children:Object(S.jsx)(R.a,{loading:r,icon:"arrow down",onClick:function(){return n()}})})},$=function(e){var t=e.rules,n=e.search,c=e.showMore,s=e.displayAmount,a=e.rBook,u=Object(r.useState)(-1),o=Object(i.a)(u,2),l=o[0],d=o[1],b=Object(r.useState)([]),j=Object(i.a)(b,2),f=j[0],x=j[1],O=Object(r.useState)(!1),h=Object(i.a)(O,2),g=h[0],v=h[1];Object(r.useEffect)((function(){x(t.slice(0,s)),v(!1)}),[s,t]),Object(r.useEffect)((function(){d(-1)}),[n]);return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(E.a,{styled:!0,fluid:!0,children:f.map((function(e){return Object(S.jsx)(z,{id:e.id,rule:e.text,activeIndex:l,setActiveIndex:d,rBook:a},e.id)}))}),t.length>s&&Object(S.jsx)(G,{autoLoadMore:function(){v(!0),setTimeout((function(){c()}),150)},showMore:c,isLoading:g})]})},D=n(174),J=function(e){return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(D.a,{placeholder:"search",fluid:!0,icon:"search",value:e.value,onChange:e.onChange,loading:e.loading}),e.searchResultNumber," ",1===e.searchResultNumber?"result":"results"," found",""!==e.value&&Object(S.jsx)(R.a,{onClick:e.clearSearch,compact:!0,basic:!0,size:"tiny",children:"clear"})]})},_=function(e){var t=e.rBook,n=Object(r.useState)(t.rules),c=Object(i.a)(n,2),s=c[0],a=c[1],u=Object(r.useState)(0),o=Object(i.a)(u,2),l=o[0],d=o[1],b=Object(r.useState)(""),j=Object(i.a)(b,2),f=j[0],x=j[1],O=Object(r.useState)(!1),h=Object(i.a)(O,2),w=h[0],H=h[1],I=Object(r.useState)(30),E=Object(i.a)(I,2),A=E[0],B=E[1],M=Object(r.useState)(""),N=Object(i.a)(M,2),R=N[0],T=N[1],F=Object(r.useState)("Magic: The Gathering -rulebook"),L=Object(i.a)(F,2),z=L[0],G=L[1];Object(r.useEffect)((function(){if(B(30),0!==f.length){H(!0);var e=setTimeout((function(){a(function(e,t){return""===t?e:e.filter((function(e){return e.text.toLowerCase().includes(t.toLowerCase())}))}(t.rules,f)),H(!1)}),700);return function(){clearTimeout(e)}}H(!1)}),[f,t.rules]);var D=function(){x(""),T(""),a(t.rules),G("Magic: The Gathering -rulebook")};Object(r.useEffect)((function(){d(s.length)}),[s]);return Object(S.jsx)(p.a,{stackable:!0,children:Object(S.jsxs)(p.a.Row,{columns:2,divided:!0,children:[Object(S.jsx)(p.a.Column,{width:5,children:Object(S.jsx)(y,{headers:v(t.headers,s,f),subHeaders:m(t.subHeaders,s,f),subHeaderClick:function(e){x(""),a(g(t.rules,parseInt(e))),T(e.substring(0,1)),G(e)},headersActive:R})}),Object(S.jsxs)(p.a.Column,{width:11,children:[Object(S.jsx)(p.a.Row,{children:Object(S.jsx)(J,{value:f,onChange:function(e){var t=e.target;x(t.value),H(!1),""===t.value?D():T("all")},loading:w,searchResultNumber:l,clearSearch:D})}),Object(S.jsxs)(p.a.Row,{children:[Object(S.jsx)(k.a,{}),Object(S.jsx)(C.a,{children:f?"Search result for:'".concat(f,"'"):z}),Object(S.jsx)($,{rules:s,search:f,displayAmount:A,showMore:function(){B(A+30)},rBook:t})]})]})]})})};var q=function(){var e=Object(r.useState)({}),t=Object(i.a)(e,2),n=t[0],c=t[1],s=Object(r.useState)(!1),a=Object(i.a)(s,2),u=a[0],o=a[1],l=Object(r.useState)(!1),d=Object(i.a)(l,2),g=d[0],v=d[1];return Object(r.useEffect)((function(){o(!0),b.getData().then((function(e){c(j.parseData(e)),o(!1)})).catch((function(e){console.error(e),v(!0),o(!1)}))}),[]),Object(S.jsxs)("div",{children:[Object(S.jsx)(f.a,{inverted:!0,basic:!0,children:"An unofficial Magic: The Gathering -rulebook"}),Object(S.jsxs)(x.a,{fluid:!0,textAlign:"left",text:!0,children:[Object(S.jsx)(O.a,{active:u}),g&&Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(h.a,{name:"x",size:"massive",color:"red"}),Object(S.jsx)("div",{children:"Error loading resources"})]}),n.headers&&n.subHeaders&&n.rules&&Object(S.jsx)(_,{rBook:n})]})]})};s.a.render(Object(S.jsx)(q,{}),document.getElementById("root"))}},[[161,1,2]]]);
//# sourceMappingURL=main.f2778da9.chunk.js.map